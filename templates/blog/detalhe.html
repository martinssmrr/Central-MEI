{% extends 'base.html' %}
{% load static %}

{% block title %}{{ post.titulo }} - Central MEI{% endblock %}

{% block description %}{{ post.get_meta_description }}{% endblock %}

{% block extra_css %}
<!-- Meta tags Open Graph para compartilhamento em redes sociais -->
<meta property="og:title" content="{{ post.titulo }} - Central MEI">
<meta property="og:description" content="{{ post.get_meta_description }}">
<meta property="og:type" content="article">
{% if post.imagem %}
<meta property="og:image" content="{{ request.build_absolute_uri }}{{ post.imagem.url }}">
{% endif %}
<meta property="article:author" content="{{ post.get_display_author }}">
<meta property="article:published_time" content="{{ post.get_publication_date|date:'c' }}">
{% if post.atualizado_em != post.criado_em %}
<meta property="article:modified_time" content="{{ post.atualizado_em|date:'c' }}">
{% endif %}

<!-- Palavras-chave SEO -->
{% if post.keywords_list %}
<meta name="keywords" content="{% for keyword in post.keywords_list %}{{ keyword }}{% if not forloop.last %}, {% endif %}{% endfor %}">
{% endif %}

<!-- Tags SEO personalizadas -->
{% if post.tags_seo %}
{{ post.tags_seo|safe }}
{% endif %}

<!-- CSS para conteúdo do blog -->
<style>
.blog-content {
    font-family: Georgia, 'Times New Roman', serif;
    font-size: 18px;
    line-height: 1.8;
    color: #2c3e50;
}

.blog-content h1,
.blog-content h2,
.blog-content h3,
.blog-content h4,
.blog-content h5,
.blog-content h6 {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 600;
    margin: 2rem 0 1rem 0;
    color: #1a202c;
}

.blog-content h2 {
    font-size: 1.75rem;
    color: var(--bs-primary);
    border-left: 4px solid var(--bs-primary);
    padding-left: 1rem;
    margin-top: 3rem;
}

.blog-content h3 {
    font-size: 1.5rem;
    color: #2d3748;
    margin-top: 2.5rem;
}

.blog-content h4 {
    font-size: 1.25rem;
    color: #4a5568;
}

.blog-content p {
    margin-bottom: 1.5rem;
    text-align: justify;
}

.blog-content strong,
.blog-content b {
    font-weight: 700;
    color: #1a202c;
}

.blog-content em,
.blog-content i {
    font-style: italic;
    color: #4a5568;
}

.blog-content a {
    color: var(--bs-primary);
    text-decoration: none;
    border-bottom: 1px solid var(--bs-primary);
    transition: all 0.3s ease;
}

.blog-content a:hover {
    color: var(--bs-secondary);
    border-bottom-color: var(--bs-secondary);
}

.blog-content ul,
.blog-content ol {
    margin: 1.5rem 0;
    padding-left: 2rem;
}

.blog-content li {
    margin-bottom: 0.5rem;
    line-height: 1.6;
}

.blog-content blockquote {
    border-left: 4px solid var(--bs-primary);
    background: #f8f9fa;
    padding: 1rem 1.5rem;
    margin: 2rem 0;
    font-style: italic;
    color: #495057;
}

.blog-content table {
    width: 100%;
    margin: 2rem 0;
    border-collapse: collapse;
    border: 1px solid #dee2e6;
}

.blog-content th,
.blog-content td {
    padding: 0.75rem;
    text-align: left;
    border-bottom: 1px solid #dee2e6;
}

.blog-content th {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #495057;
}

.blog-content code {
    background: #f1f3f4;
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-size: 0.9em;
    color: #d63384;
}

.blog-content pre {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
}

/* Responsividade */
@media (max-width: 768px) {
    .blog-content {
        font-size: 16px;
        line-height: 1.7;
    }
    
    .blog-content h2 {
        font-size: 1.5rem;
        margin-top: 2rem;
    }
    
    .blog-content h3 {
        font-size: 1.3rem;
    }
    
    .blog-content ul,
    .blog-content ol {
        padding-left: 1.5rem;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="bg-light py-3">
    <div class="container">
        <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item">
                <a href="{% url 'core:home' %}" class="text-decoration-none">
                    <i class="bi bi-house-fill me-1"></i>Home
                </a>
            </li>
            <li class="breadcrumb-item">
                <a href="{% url 'blog:post_list' %}" class="text-decoration-none">Blog</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">{{ post.titulo|truncatechars:50 }}</li>
        </ol>
    </div>
</nav>

<!-- Article Header -->
<header class="py-5 bg-gradient-primary text-white">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <article class="text-center">
                    <h1 class="display-4 fw-bold mb-4">{{ post.titulo }}</h1>
                    <p class="lead mb-4">{{ post.resumo }}</p>
                    
                    <!-- Article Meta Information -->
                    <div class="d-flex flex-wrap justify-content-center align-items-center gap-4 text-white-50">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-person-circle me-2"></i>
                            <span>Por <strong class="text-white">{{ post.get_display_author }}</strong></span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-calendar3 me-2"></i>
                            <time datetime="{{ post.get_publication_date|date:'c' }}">{{ post.get_publication_date|date:"d/m/Y" }}</time>
                        </div>
                        <!-- <div class="d-flex align-items-center">
                            <i class="bi bi-clock me-2"></i>
                            <span>{{ post.get_reading_time }} min de leitura</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-eye me-2"></i>
                            <span>{{ post.get_word_count }} palavras</span>
                        </div>
                        {% if post.atualizado_em != post.criado_em %}
                        <div class="d-flex align-items-center">
                            <i class="bi bi-arrow-clockwise me-2"></i>
                            <span>Atualizado em 
                                <time datetime="{{ post.atualizado_em|date:'c' }}">{{ post.atualizado_em|date:"d/m/Y" }}</time>
                            </span>
                        </div> -->
                        {% endif %}
                    </div>
                </article>
            </div>
        </div>
    </div>
</header>

<!-- Article Content -->
<main class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <article class="blog-post-content">
                    <!-- Featured Image -->
                    {% if post.imagem %}
                    <figure class="mb-5">
                        <img src="{{ post.imagem.url }}" 
                             alt="{{ post.titulo }}" 
                             class="img-fluid rounded shadow-lg w-100 blog-featured-image">
                        <figcaption class="figure-caption text-center mt-2 text-muted">
                            Imagem ilustrativa do artigo
                        </figcaption>
                    </figure>
                    {% endif %}

                    <!-- Article Content -->
                    <div class="blog-content">
                        {{ post.conteudo|safe }}
                    </div>

                    <!-- Article Tags from Keywords -->
                    {% if post.keywords_list %}
                    <div class="mt-5 pt-4 border-top">
                        <h6 class="text-muted mb-3">
                            <i class="bi bi-tags me-2"></i>Palavras-chave:
                        </h6>
                        <div class="d-flex flex-wrap gap-2">
                            {% for keyword in post.keywords_list %}
                                {% cycle 'bg-primary' 'bg-secondary' 'bg-success' 'bg-info' 'bg-warning text-dark' as badge_colors silent %}
                                <span class="badge {{ badge_colors }}">{{ keyword }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </article>
            </div>
        </div>
    </div>
</main>

<!-- Call to Action -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 text-center">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="h4 text-primary mb-3">
                            <i class="bi bi-chat-dots me-2"></i>
                            Precisa de Ajuda?
                        </h3>
                        <p class="text-muted mb-4">
                            Nossa equipe está pronta para ajudar você com todas as questões relacionadas ao seu MEI.
                        </p>
                        <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center">
                            <a href="https://wa.me/5511031642284?text=Quero%20conhecer%20mais%20sobre%20a%20Central%20MEI" 
                               target="_blank" 
                               rel="noopener noreferrer"
                               class="btn btn-success">
                                <i class="bi bi-whatsapp me-2"></i>Falar no WhatsApp
                            </a>
                            <a href="{% url 'servicos:lista' %}" class="btn btn-outline-primary">
                                <i class="bi bi-briefcase me-2"></i>Ver Serviços
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Navigation Between Posts -->
<section class="py-4 bg-gray-100">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <!-- Previous Post (if exists) -->
                <div class="d-flex align-items-center">
                    <a href="{% url 'blog:post_list' %}" 
                       class="btn btn-outline-secondary me-3"
                       aria-label="Voltar para lista de artigos">
                        <i class="bi bi-arrow-left"></i>
                    </a>
                    <div>
                        <small class="text-muted d-block">Voltar para</small>
                        <a href="{% url 'blog:post_list' %}" 
                           class="text-decoration-none fw-medium">
                            Lista de Artigos
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-6 text-md-end">
                <!-- Share Options -->
                <div class="d-flex align-items-center justify-content-md-end mt-3 mt-md-0">
                    <small class="text-muted me-3">Compartilhar:</small>
                    <div class="d-flex gap-2">
                        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" 
                           target="_blank" 
                           rel="noopener noreferrer"
                           class="btn btn-outline-primary btn-sm"
                           aria-label="Compartilhar no Facebook">
                            <i class="bi bi-facebook"></i>
                        </a>
                        <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ post.titulo|urlencode }}" 
                           target="_blank" 
                           rel="noopener noreferrer"
                           class="btn btn-outline-info btn-sm"
                           aria-label="Compartilhar no Twitter">
                            <i class="bi bi-twitter"></i>
                        </a>
                        <a href="https://wa.me/?text={{ post.titulo|urlencode }}%20{{ request.build_absolute_uri|urlencode }}" 
                           target="_blank" 
                           rel="noopener noreferrer"
                           class="btn btn-outline-success btn-sm"
                           aria-label="Compartilhar no WhatsApp">
                            <i class="bi bi-whatsapp"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Related Articles Suggestion -->
<section class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="h3 text-primary">Outros Artigos que Podem Interessar</h2>
            <p class="text-muted">Continue aprendendo sobre o mundo MEI</p>
        </div>
        
        <div class="row g-4">
            {% comment %}
            <!-- This would be populated with related posts logic in views.py -->
            <!-- For now, we'll show a placeholder that can be populated later -->
            {% endcomment %}
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-journal-text text-primary mb-3 blog-icon-large"></i>
                        <h5 class="card-title">Mais Artigos</h5>
                        <p class="card-text text-muted">
                            Explore nossa biblioteca completa de artigos sobre MEI e empreendedorismo.
                        </p>
                        <a href="{% url 'blog:post_list' %}" class="btn btn-outline-primary">
                            Ver Todos os Artigos
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-person-plus text-success mb-3 blog-icon-large"></i>
                        <h5 class="card-title">Abrir MEI</h5>
                        <p class="card-text text-muted">
                            Comece sua jornada empreendedora abrindo seu MEI conosco.
                        </p>
                        <a href="{% url 'servicos:abrir_mei' %}" class="btn btn-outline-success">
                            Abrir Meu MEI
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-file-text text-warning mb-3 blog-icon-large"></i>
                        <h5 class="card-title">Declaração Anual</h5>
                        <p class="card-text text-muted">
                            Mantenha seu MEI em dia com nossa declaração anual.
                        </p>
                        <a href="{% url 'servicos:declaracao_mei' %}" class="btn btn-outline-warning">
                            Fazer Declaração
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}